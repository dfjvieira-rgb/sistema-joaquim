<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MENTORIA ELITE 2026</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #1e293b; --gold: #fbbf24; --accent: #3b82f6;
            --tese-bg: #f5f3ff; --tese-border: #7c3aed;
            --confunda-bg: #fef2f2; --confunda-border: #ef4444;
            --desafio-bg: #ecfeff; --desafio-border: #0891b2;
        }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f8fafc; margin: 0; padding: 0; color: #334155; }
        
        /* Layout Portal */
        header { background: var(--primary); color: white; padding: 20px; text-align: center; border-bottom: 4px solid var(--gold); }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }

        /* Estilo dos Cards de Conte√∫do */
        .mentoria-card {
            background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px;
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border-left: 10px solid #ddd;
            display: none; /* Escondido at√© o clique */
            animation: slideIn 0.4s ease-out;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .card-desafio { border-color: var(--desafio-border); background: var(--desafio-bg); }
        .card-tese { border-color: var(--tese-border); background: var(--tese-bg); }
        .card-confunda { border-color: var(--confunda-border); background: var(--confunda-bg); }

        .card-title { font-weight: 900; text-transform: uppercase; font-size: 0.8rem; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        .card-title i { font-size: 1.1rem; }
        .text-body { font-size: 1.05rem; line-height: 1.6; color: #1e293b; }

        /* Lista de Hist√≥rico */
        .historico-section { background: #fff; border-radius: 12px; overflow: hidden; border: 1px solid #e2e8f0; margin-top: 30px; }
        .historico-header { background: #f1f5f9; padding: 15px; font-weight: 800; border-bottom: 1px solid #e2e8f0; display: flex; justify-content: space-between; }
        .item-envio { display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #f1f5f9; }
        .btn-analisar { background: var(--accent); color: white; border: none; padding: 8px 16px; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-analisar:hover { background: #2563eb; transform: scale(1.05); }

        .badge-peca { background: var(--primary); color: var(--gold); padding: 4px 10px; border-radius: 20px; font-size: 0.7rem; font-weight: 800; margin-top: 5px; display: inline-block; }
    </style>
</head>
<body>

<header>
    <div style="font-size: 1.5rem; font-weight: 900;">MENTORIA <span style="color:var(--gold)">ARYANNA</span></div>
    <div style="font-size: 0.8rem; opacity: 0.8;">LABORAT√ìRIO DE ELITE 2026</div>
</header>

<div class="container">
    
    <div id="card-desafio" class="mentoria-card card-desafio">
        <div class="card-title" style="color: var(--desafio-border)"><i class="fas fa-bullseye"></i> Desafio: Qual √© a Pe√ßa?</div>
        <div id="txt-desafio" class="text-body"></div>
    </div>

    <div id="card-tese" class="mentoria-card card-tese">
        <div class="card-title" style="color: var(--tese-border)"><i class="fas fa-gavel"></i> Teses e Fundamenta√ß√£o</div>
        <div id="txt-tese" class="text-body"></div>
    </div>

    <div id="card-confunda" class="mentoria-card card-confunda">
        <div class="card-title" style="color: var(--confunda-border)"><i class="fas fa-exclamation-triangle"></i> N√£o Confunda</div>
        <div id="txt-confunda" class="text-body"></div>
    </div>

    <div class="historico-section">
        <div class="historico-header">
            <span>HIST√ìRICO DE TREINOS</span>
            <button onclick="window.close()" style="border:none; background:none; cursor:pointer; font-size:0.7rem; font-weight:bold;">[ FECHAR ]</button>
        </div>
        <div id="lista-envios">
            </div>
    </div>
</div>

<script type="module">
    import { db } from './firebase-config.js';
    import { ref, onValue, get } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";

    // O BANCO DE DADOS DA MENTORIA (TESES)
    const CONTEUDO_MENTORIA = {
        "CONTESTA√á√ÉO": {
            desafio: "Identifique se o caso √© de <b>Defesa</b>. O examinador dir√° que seu cliente foi citado para responder a uma reclama√ß√£o. <br>üéØ <i>A√ß√£o Reacional.</i>",
            tese: "<b>Estrutura de Ouro:</b><br>1. Preliminares (Art. 337 CPC)<br>2. Prejudiciais (Prescri√ß√£o - Art. 7, XXIX CF)<br>3. M√©rito (Negativa dos Fatos ou Fato Impeditivo).",
            confunda: "<b>CUIDADO!</b> N√£o confunda o prazo. Na JT a contesta√ß√£o √© apresentada at√© a audi√™ncia (Art. 847 CLT)."
        },
        "RECURSO ORDIN√ÅRIO": {
            desafio: "Procure pela palavra <b>Senten√ßa</b>. Se o juiz decidiu e voc√™ precisa atacar essa decis√£o no Tribunal, o caminho √© o RO.",
            tese: "<b>Fundamento:</b> Art. 895, I da CLT.<br>N√£o esque√ßa do <b>Preparo</b> (Custas + Dep√≥sito), sob pena de deser√ß√£o.",
            confunda: "O RO √© o equivalente √† Apela√ß√£o do C√≠vel. N√£o use o nome 'Apela√ß√£o' jamais!"
        }
    };

    // Carregar Lista
    onValue(ref(db, 'mentoria/historico'), (snapshot) => {
        const grid = document.getElementById('lista-envios');
        grid.innerHTML = "";
        const envios = snapshot.val();
        if(envios) {
            Object.keys(envios).map(k => ({id: k, ...envios[k]}))
            .sort((a,b) => b.ts - a.ts)
            .forEach(item => {
                const div = document.createElement('div');
                div.className = 'item-envio';
                div.innerHTML = `
                    <div>
                        <div style="font-weight:bold">Exame OAB ${item.exame}</div>
                        <div style="font-size:0.7rem; color:#666">${item.data}</div>
                    </div>
                    <button class="btn-analisar" onclick="gerarMentoria('${item.exame}')">ANALISAR</button>
                `;
                grid.appendChild(div);
            });
        }
    });

    window.gerarMentoria = async (exNum) => {
        const snap = await get(ref(db, `estudos/${exNum}`));
        const dados = snap.val();
        if(!dados) return alert("Conte√∫do n√£o encontrado.");

        const texto = dados.linhas.join(" ").toUpperCase();
        let pecaSugerida = "N√ÉO IDENTIFICADA";

        // Busca qual pe√ßa est√° no texto
        for (let p in CONTEUDO_MENTORIA) {
            if (texto.includes(p)) pecaSugerida = p;
        }

        if(CONTEUDO_MENTORIA[pecaSugerida]) {
            const info = CONTEUDO_MENTORIA[pecaSugerida];
            
            // Injetar nos cards
            document.getElementById('txt-desafio').innerHTML = `Pe√ßa: <b>${pecaSugerida}</b><br><br>${info.desafio}`;
            document.getElementById('txt-tese').innerHTML = info.tese;
            document.getElementById('txt-confunda').innerHTML = info.confunda;

            // Mostrar os cards com anima√ß√£o
            document.querySelectorAll('.mentoria-card').forEach(c => c.style.display = 'block');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
            alert("O sistema n√£o identificou o nome da pe√ßa nas suas linhas para gerar as teses.");
        }
    };

    Object.assign(window, { gerarMentoria });
</script>
</body>
</html>
