<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SISTEMA JOAQUIM - MENTORIA</title>
    <style>
        :root { --primary: #0f172a; --accent: #3b82f6; --bg: #f8fafc; --sidebar-bg: #1e293b; --postit-yellow: #fef9c3; --guia-bg: #ecfdf5; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #334155; }
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        #main-app { display: none; }
        header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: 800; border-bottom: 4px solid var(--accent); }
        .main-layout { display: flex; min-height: 100vh; }
        .sidebar { width: 220px; background: var(--sidebar-bg); padding: 15px; flex-shrink: 0; }
        .nav-btn { width: 100%; text-align: left; padding: 10px; margin-bottom: 5px; border: none; background: rgba(255,255,255,0.08); color: #f8fafc; cursor: pointer; border-radius: 6px; font-size: 0.75rem; }
        .nav-btn.active { background: var(--accent); }
        .content-area { padding: 20px; flex-grow: 1; max-width: 900px; margin: 0 auto; }
        #joaquim { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); min-height: 70vh; border: 1px solid #e2e8f0; font-family: 'Times New Roman', serif; }
        .gabarito-panel { background: #f1f5f9; border: 2px solid var(--accent); padding: 12px; border-radius: 10px; margin-bottom: 20px; }
        .gab-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
        .gab-btn { background: var(--accent); color: white; border: none; padding: 8px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 0.7rem; }
        .guia-btn { width: 100%; background: #10b981; color: white; border: none; padding: 10px; border-radius: 6px; font-weight: bold; margin-top: 8px; cursor: pointer; }
        .gab-content, .guia-content { display: none; margin-top: 15px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #ddd; white-space: pre-wrap; font-size: 0.9rem; }
        .guia-content { background: var(--guia-bg); border-color: #10b981; }
        .copy-btn { width: 100%; margin-bottom: 20px; background: #10b981; color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        #texto-final { outline: none; min-height: 400px; white-space: pre-wrap; margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 20px; }
    </style>
</head>
<body>

<div id="login-screen">
    <button onclick="liberar()" style="padding:20px; cursor:pointer; background:var(--accent); color:white; border:none; border-radius:8px;">ENTRAR NO SISTEMA</button>
</div>

<div id="main-app">
    <header>SISTEMA JOAQUIM - MENTORIA JUR√çDICA</header>
    <div class="main-layout">
        <nav class="sidebar" id="menuLateral"></nav>
        <main class="content-area">
            <div id="joaquim">Selecione uma pe√ßa ao lado.</div>
        </main>
    </div>
</div>

<script src="gabarito.js"></script>
<script>
    const pecas = {
        'rt': 'Reclama√ß√£o Trabalhista', 'consigna': 'Consigna√ß√£o em Pagamento', 'cont': 'Contesta√ß√£o',
        'emb_exec': 'Embargos √† Execu√ß√£o', 'ro': 'Recurso Ordin√°rio', 'ed': 'Embargos de Declara√ß√£o',
        'ap': 'Agravo de Peti√ß√£o', 'ai': 'Agravo de Instrumento', 'rr': 'Recurso de Revista'
    };

    function liberar() {
        document.getElementById('login-screen').style.display = 'none';
        document.getElementById('main-app').style.display = 'block';
        montarMenu();
    }

    function montarMenu() {
        let h = '';
        Object.keys(pecas).forEach(k => {
            h += `<button class="nav-btn" id="btn_${k}" onclick="loadPeca('${k}')">${pecas[k]}</button>`;
        });
        document.getElementById('menuLateral').innerHTML = h;
    }

    function loadPeca(key) {
        const dados = window.dbGabaritosExternos[key];
        if (!dados) return;

        let botoes = '', blocos = '', guiaHtml = '';

        // Gabarito 1
        if(dados[1]) {
            botoes += `<button class="gab-btn" onclick="toggleC('${key}_1')">üìñ Gabarito 1</button>`;
            blocos += `<div id="${key}_1" class="gab-content">${dados[1]}</div>`;
        }

        // Guia
        if(dados.guia) {
            guiaHtml = `
                <button class="guia-btn" onclick="toggleC('${key}_guia')">üí° DICAS DE MENTORIA</button>
                <div id="${key}_guia" class="guia-content">${dados.guia}</div>
            `;
        }

        document.getElementById('joaquim').innerHTML = `
            <button class="copy-btn" onclick="copyC()">COPIAR PETI√á√ÉO</button>
            <div class="gabarito-panel">
                <div class="gab-grid">${botoes}</div>
                ${guiaHtml}
                ${blocos}
            </div>
            <div id="texto-final" contenteditable="true">ID: 936045\n\n(Escreva sua pe√ßa aqui...)</div>
        `;
    }

    function toggleC(id) {
        const el = document.getElementById(id);
        const atual = el.style.display;
        document.querySelectorAll('.gab-content, .guia-content').forEach(d => d.style.display = 'none');
        el.style.display = atual === 'block' ? 'none' : 'block';
    }

    function copyC() {
        const t = document.getElementById('texto-final').innerText;
        navigator.clipboard.writeText(t).then(() => alert("Copiado!"));
    }
</script>
</body>
</html>
