<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SISTEMA JOAQUIM PRO - M√âTODO ARYANNA</title>
    <style>
        :root { 
            --primary: #1a252f; --accent: #f1c40f; --bg: #f8f9fa; 
            --header-h: 60px; --drawer-w: 280px; --yellow-light: #fffde7;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg); height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

        header { background: var(--primary); color: white; height: var(--header-h); padding: 0 15px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .timer { font-family: monospace; font-weight: bold; color: var(--accent); }

        /* MENU LATERAL */
        .drawer { position: fixed; top: 0; left: -100%; width: var(--drawer-w); height: 100%; background: white; z-index: 2000; transition: 0.3s; box-shadow: 5px 0 15px rgba(0,0,0,0.3); overflow-y: auto; }
        .drawer.open { left: 0; }
        .drawer-header { background: var(--primary); color: white; padding: 30px 20px; }
        .drawer-item { padding: 15px 20px; border-bottom: 1px solid #eee; cursor: pointer; display: flex; align-items: center; gap: 10px; color: #333; font-weight: 500; }

        /* WORKSPACE */
        .view { display: none; flex: 1; overflow: hidden; }
        .view.active { display: flex; flex-direction: column; }
        .workspace { display: flex; flex: 1; overflow: hidden; }
        .col { display: flex; flex-direction: column; border-right: 1px solid #ddd; }
        
        /* COLUNAS */
        .col-respostas { flex: 1.2; background: white; }
        .col-dicas { flex: 0.8; background: var(--yellow-light); }
        .col-apoio { flex: 1; background: #525659; }

        /* CABE√áALHOS */
        .cad-header { padding: 8px 12px; font-size: 0.7rem; font-weight: bold; color: white; display: flex; justify-content: space-between; align-items: center; }
        .bg-oab { background: var(--primary); }
        .bg-dicas { background: #f39c12; }

        /* INPUTS DE TEXTO */
        .paper { flex: 1; display: flex; overflow-y: auto; background-image: linear-gradient(#e1e1e1 1px, transparent 1px); background-size: 100% 25px; background-attachment: local; }
        .line-nums { width: 35px; background: #f8f9fa; border-right: 1px solid #ddd; text-align: center; color: #bbb; font-size: 11px; line-height: 25px; padding-top: 25px; }
        textarea { flex: 1; padding: 25px; border: none; outline: none; resize: none; font-family: 'Times New Roman', serif; font-size: 17px; line-height: 25px; background: transparent; }

        /* SISTEMA DE SALVAMENTO DE DICAS */
        .dicas-controls { padding: 10px; background: #eee; display: flex; gap: 5px; border-bottom: 1px solid #ddd; }
        .dicas-controls input { flex: 1; padding: 5px; border: 1px solid #ccc; border-radius: 3px; font-size: 0.8rem; }
        .btn-save { background: #27ae60; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; font-size: 0.7rem; font-weight: bold; }
        .dicas-list { max-height: 120px; overflow-y: auto; background: #fff; padding: 5px; border-bottom: 2px solid #f39c12; }
        .dica-salva { font-size: 0.7rem; padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; cursor: pointer; }

        /* PDF NAV */
        .pdf-nav { display: flex; background: #333; }
        .pdf-btn { flex: 1; border: none; background: #444; color: #ccc; padding: 10px; font-size: 0.6rem; cursor: pointer; border-right: 1px solid #555; }
        .pdf-btn.active { background: var(--accent); color: var(--primary); font-weight: bold; }

        /* RESPONSIVIDADE */
        @media (max-width: 1024px) {
            .workspace { flex-direction: column; overflow-y: auto; }
            .col { width: 100%; height: 500px; flex: none; }
            #mural { grid-template-columns: 1fr; }
        }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 1500; display: none; }
        .overlay.active { display: block; }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="toggleMenu()"></div>

<header>
    <div onclick="toggleMenu()" style="cursor:pointer; font-size: 1.5rem; padding: 10px;">‚ò∞</div>
    <div style="font-weight:bold;">SISTEMA <span style="color:var(--accent)">JOAQUIM</span></div>
    <div class="timer" id="timer">05:00:00</div>
</header>

<nav class="drawer" id="drawer">
    <div class="drawer-header"><b>BIBLIOTECA DE ESTUDO</b></div>
    <div class="drawer-item" onclick="showView('treino'); toggleMenu()">üìù Caderno de Treino</div>
    <div class="drawer-item" onclick="showView('estruturas'); toggleMenu()">üìë Gerador de Pe√ßas</div>
    <div class="drawer-item" onclick="showView('postits'); toggleMenu()">üìå Mural de Post-its</div>
    <div class="drawer-item" onclick="showView('apostila'); toggleMenu()">üìñ Apostila PDF</div>
</nav>

<main id="view-treino" class="view active">
    <div class="workspace">
        
        <section class="col col-respostas">
            <div class="cad-header bg-oab"><span>CADERNO DE RESPOSTAS</span><span id="line-info">Linha: 1</span></div>
            <div class="paper">
                <div class="line-nums" id="ln-res"></div>
                <textarea id="area-peca" oninput="saveCurrent()" placeholder="Redija sua pe√ßa..."></textarea>
            </div>
        </section>

        <section class="col col-dicas">
            <div class="cad-header bg-dicas"><span>DICAS DE AULA / RASCUNHOS</span></div>
            
            <div class="dicas-controls">
                <input type="text" id="dica-assunto" placeholder="Ex: Aula 01 - RO">
                <button class="btn-save" onclick="salvarDicaAula()">SALVAR</button>
            </div>
            
            <div class="dicas-list" id="dicas-salvas-container">
                </div>

            <div class="paper">
                <div class="line-nums" style="background:#fffde7;">‚Ä¢</div>
                <textarea id="area-dicas" oninput="saveCurrent()" placeholder="Anote as dicas da Aryanna..."></textarea>
            </div>
        </section>

        <section class="col col-apoio">
            <div class="pdf-nav">
                <button class="pdf-btn active" id="b-prova" onclick="loadPDF('prova')">PROVA</button>
                <button class="pdf-btn" id="b-gab" onclick="loadPDF('gab')">GABARITO</button>
                <button class="pdf-btn" id="b-apoio" onclick="loadPDF('apoio')">APOSTILA</button>
            </div>
            <iframe id="f-pdf" src="./ro35.pdf" style="flex:1; border:none; background:white;"></iframe>
        </section>

    </div>
</main>

<main id="view-estruturas" class="view"><div style="padding:20px;">Use o bot√£o "Gerador de Pe√ßas" no menu para modelos r√°pidos.</div></main>
<main id="view-postits" class="view"><div id="mural"></div></main>
<main id="view-apostila" class="view"><iframe src="./Aryanna Linhares.pdf" style="width:100%; height:100%; border:none;"></iframe></main>

<script>
    // Configura√ß√µes e Linhas
    const lineRes = document.getElementById('ln-res');
    for(let i=1; i<=150; i++) lineRes.innerHTML += i + '<br>';

    function toggleMenu() {
        document.getElementById('drawer').classList.toggle('open');
        document.getElementById('overlay').classList.toggle('active');
    }

    function showView(v) {
        document.querySelectorAll('.view').forEach(view => view.classList.remove('active'));
        document.getElementById('view-' + v).classList.add('active');
    }

    function loadPDF(tipo) {
        const paths = { prova: './ro35.pdf', gab: './ro35-gabarito.pdf', apoio: './Aryanna Linhares.pdf' };
        document.getElementById('f-pdf').src = paths[tipo];
        document.querySelectorAll('.pdf-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('b-' + tipo).classList.add('active');
    }

    // --- L√ìGICA DE SALVAMENTO DE AULAS ---
    let bancoDicas = JSON.parse(localStorage.getItem('joaquim_banco_dicas')) || [];

    function salvarDicaAula() {
        const assunto = document.getElementById('dica-assunto').value;
        const texto = document.getElementById('area-dicas').value;

        if(!assunto) { alert("D√™ um nome ao assunto da aula!"); return; }

        const novaDica = {
            id: Date.now(),
            assunto: assunto,
            texto: texto,
            data: new Date().toLocaleDateString()
        };

        bancoDicas.unshift(novaDica); // Adiciona no topo
        localStorage.setItem('joaquim_banco_dicas', JSON.stringify(bancoDicas));
        renderListaDicas();
        alert("Rascunho de aula salvo!");
    }

    function renderListaDicas() {
        const container = document.getElementById('dicas-salvas-container');
        container.innerHTML = bancoDicas.length ? "" : "<p style='font-size:0.6rem; padding:10px; color:#999;'>Nenhum rascunho salvo.</p>";
        
        bancoDicas.forEach(dica => {
            const div = document.createElement('div');
            div.className = 'dica-salva';
            div.innerHTML = `<b>${dica.assunto}</b> <span>${dica.data}</span>`;
            div.onclick = () => carregarDica(dica.id);
            container.appendChild(div);
        });
    }

    function carregarDica(id) {
        const dica = bancoDicas.find(d => d.id === id);
        if(dica && confirm(`Carregar rascunho: ${dica.assunto}?`)) {
            document.getElementById('area-dicas').value = dica.texto;
            document.getElementById('dica-assunto').value = dica.assunto;
            saveCurrent();
        }
    }

    function saveCurrent() {
        localStorage.setItem('j_peca_atual', document.getElementById('area-peca').value);
        localStorage.setItem('j_dica_atual', document.getElementById('area-dicas').value);
        document.getElementById('line-info').innerText = "Linha: " + document.getElementById('area-peca').value.split('\n').length;
    }

    window.onload = () => {
        document.getElementById('area-peca').value = localStorage.getItem('j_peca_atual') || "";
        document.getElementById('area-dicas').value = localStorage.getItem('j_dica_atual') || "";
        renderListaDicas();
        saveCurrent();
    };

    // Timer
    let s = 18000;
    setInterval(() => {
        if(s > 0) {
            s--;
            let h = Math.floor(s/3600), m = Math.floor((s%3600)/60), sc = s%60;
            document.getElementById('timer').innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${sc.toString().padStart(2,'0')}`;
        }
    }, 1000);
</script>
</body>
</html>
