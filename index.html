const montarFolha = () => {
    const container = document.getElementById('folha-total');
    container.innerHTML = "";
    
    for(let i=1; i<=180; i++) {
        if(i === 1 || i === 51) {
            const h = document.createElement('div');
            h.style.cssText = "background:#1e293b; color:#fbbf24; padding:8px; text-align:center; font-size:0.7rem; font-weight:bold;";
            h.innerText = i === 1 ? 'CADERNO DE RESPOSTAS - PEÇA' : 'CADERNO DE RESPOSTAS - QUESTÕES';
            container.appendChild(h);
        }
        const row = document.createElement('div');
        row.className = 'linha-wrapper';
        const input = document.createElement('input');
        input.className = 'linha-folha';
        input.id = `L${i}`;
        input.setAttribute('spellcheck', 'false');
        input.setAttribute('maxlength', LIMITE_LINHA);

        // --- LÓGICA DE APAGAR AO ARRASTAR (MOUSEOVER) ---
        input.onmouseover = (e) => {
            // Se o botão esquerdo do mouse estiver pressionado E a tecla Shift estiver segurada
            if (e.buttons === 1 && e.shiftKey) {
                input.value = "";
                input.classList.add('apagando');
                setTimeout(() => input.classList.remove('apagando'), 300);
            }
        };

        // AUTO-PULO AO DIGITAR
        input.oninput = () => {
            if (input.value.length >= LIMITE_LINHA) {
                document.getElementById(`L${i + 1}`)?.focus();
            }
        };

        // CONTROLE DE TECLAS
        input.onkeydown = (e) => { 
            if (e.key === "Enter") { 
                e.preventDefault(); 
                document.getElementById(`L${i + 1}`)?.focus(); 
            } 
            if (e.key === "Backspace" && input.value.length === 0) {
                document.getElementById(`L${i - 1}`)?.focus();
            }
        };

        input.onfocus = () => { ultimaLinhaFocada = i; };
        row.innerHTML = `<div class="linha-num">${i}</div>`;
        row.appendChild(input);
        container.appendChild(row);
    }
    carregarDados();
};
