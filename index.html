<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SISTEMA JOAQUIM - Workspace OAB 2¬™ Fase</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --bg: #f0f2f5; --orange: #e67e22; --header-h: 70px; }
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: var(--bg); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* HEADER COM CRON√îMETRO E LINHA DO TEMPO */
        header { background-color: var(--primary); color: white; height: var(--header-h); padding: 0 1.5rem; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.2); z-index: 100; }
        #timer { font-size: 1.4rem; font-weight: bold; color: #f1c40f; }
        
        .timeline-dropdown { position: relative; display: inline-block; }
        .dropbtn { background-color: var(--accent); color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; font-size: 0.75rem; }
        .dropdown-content { display: none; position: absolute; background: white; min-width: 220px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); right: 0; border-radius: 4px; z-index: 1000; }
        .dropdown-content a { color: #333; padding: 12px; text-decoration: none; display: block; border-bottom: 1px solid #eee; font-size: 0.8rem; }
        .dropdown-content a:hover { background: #f1f1f1; }
        .timeline-dropdown:hover .dropdown-content { display: block; }

        /* NAVEGA√á√ÉO MOBILE */
        .tabs-container { display: none; background: #34495e; padding: 5px; gap: 5px; }
        .tab-btn { flex: 1; padding: 12px; border: none; background: #2c3e50; color: white; border-radius: 4px; font-weight: bold; font-size: 0.8rem; }
        .tab-btn.active { background: var(--accent); }

        main { display: flex; flex: 1; overflow: hidden; position: relative; }

        /* SIDEBAR DE EXAMES */
        .sidebar { width: 230px; background: white; padding: 1.2rem; border-right: 1px solid #ddd; flex-shrink: 0; overflow-y: auto; }
        .btn-peca { width: 100%; padding: 12px; margin-bottom: 8px; background: white; border: 1px solid #dcdde1; border-radius: 6px; cursor: pointer; text-align: left; font-size: 0.85rem; }
        .btn-peca.active-peca { border-left: 5px solid var(--accent); background: #eef7ff; font-weight: bold; }

        /* WORK SECTION (EDITOR + TESES INTELIGENTES) */
        .work-section { flex: 1; min-width: 320px; display: flex; flex-direction: column; background: white; border-right: 1px solid #ddd; position: relative; }
        
        #panel-fundamentos { display: none; background: #fdf2e9; border-bottom: 3px solid var(--orange); padding: 15px; overflow-y: auto; max-height: 45%; }
        #panel-fundamentos.open { display: flex; flex-direction: column; }
        
        .tese-item { background: white; border: 1px solid #e67e22; border-radius: 6px; padding: 10px; margin-bottom: 8px; display: flex; flex-direction: column; gap: 5px; }
        .tese-item textarea { width: 100%; border: 1px solid #eee; resize: vertical; font-size: 0.85rem; font-family: inherit; outline: none; }
        .tese-tag { font-size: 0.65rem; font-weight: bold; color: var(--orange); text-transform: uppercase; }

        .editor-container { flex: 1; padding: 12px; display: flex; flex-direction: column; }
        #area-peca { flex: 1; padding: 20px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 1.1rem; resize: none; outline: none; }

        .resizer { width: 12px; background: #dfe6e9; cursor: col-resize; flex-shrink: 0; display: flex; align-items: center; justify-content: center; color: #7f8c8d; }

        /* PDF SECTION */
        .pdf-section { flex: 1.2; background: #dcdde1; display: flex; flex-direction: column; gap: 4px; padding: 4px; overflow: hidden; }
        .pdf-box { flex: 1; display: flex; flex-direction: column; background: white; transition: flex 0.3s ease; }
        .pdf-box.focado { flex: 30 !important; }
        .pdf-box.encolhido { flex: 0 !important; min-height: 0; overflow: hidden; }
        .pdf-header { background: #34495e; color: white; padding: 8px 12px; display: flex; justify-content: space-between; align-items: center; font-size: 0.75rem; }
        .action-btn { background: var(--accent); color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 0.65rem; font-weight: bold; }
        iframe { width: 100%; height: 100%; border: none; }

        @media (max-width: 900px) {
            header { flex-direction: column; height: auto; padding: 10px; gap: 10px; }
            .tabs-container { display: flex; }
            .sidebar, .resizer, .pdf-section { display: none; }
            .content-section { display: none; width: 100%; height: 100%; }
            .active-mobile { display: flex !important; }
        }
    </style>
</head>
<body>

<header>
    <div style="display:flex; align-items:center; gap:15px;">
        <h1 style="margin:0; font-size: 1.1rem; letter-spacing: 1px;">SISTEMA JOAQUIM</h1>
        <div id="timer">05:00:00</div>
    </div>
    
    <div class="timeline-dropdown">
        <button class="dropbtn">‚è≥ LINHA DO TEMPO (ESQUELETOS)</button>
        <div class="dropdown-content">
            <a href="javascript:void(0)" onclick="abrirEsqueleto('RT')">1. Reclama√ß√£o Trabalhista</a>
            <a href="javascript:void(0)" onclick="abrirEsqueleto('CON')">2. Contesta√ß√£o</a>
            <a href="javascript:void(0)" onclick="abrirEsqueleto('RO')">3. Recurso Ordin√°rio</a>
            <a href="javascript:void(0)" onclick="abrirEsqueleto('AP')">4. Agravo de Peti√ß√£o</a>
        </div>
    </div>
</header>

<nav class="tabs-container">
    <button class="tab-btn active" id="t-lista" onclick="switchTab('lista')">üìÇ PE√áAS</button>
    <button class="tab-btn" id="t-work" onclick="switchTab('work')">‚úçÔ∏è TREINO</button>
    <button class="tab-btn" id="t-docs" onclick="switchTab('docs')">üìÑ PDFS</button>
</nav>

<main>
    <nav class="sidebar content-section active-mobile" id="lista">
        <h2 style="font-size:0.8rem; color:#7f8c8d;">EXAMES DISPON√çVEIS</h2>
        <button class="btn-peca" id="btn-ro35" onclick="carregarExame('ro35.pdf', 'ro35-gabarito.pdf', 'ro35')">Recurso Ordin√°rio (Exame 35)</button>
    </nav>

    <section class="work-section content-section" id="work">
        <div id="panel-fundamentos">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                <strong style="color:var(--orange)">TESES INTELIGENTES (ARTIGOS, OJs, S√öMULAS)</strong>
                <button class="action-btn" onclick="adicionarTese()">+ NOVA TESE</button>
            </div>
            <div id="container-teses"></div>
        </div>

        <div class="editor-container">
            <div style="display:flex; gap:8px; margin-bottom:10px;">
                <button class="action-btn" style="background:var(--orange); flex:1" onclick="toggleTeses()">üìö VER TESES DO EXAME</button>
                <button class="action-btn" style="background:#27ae60; flex:1" onclick="exportarTXT()">üíæ SALVAR TXT</button>
            </div>
            <textarea id="area-peca" placeholder="Desenvolva sua pe√ßa profissional aqui..."></textarea>
        </div>
    </section>

    <div class="resizer" id="dragMe">‚ãÆ</div>

    <section class="pdf-section content-section" id="docs">
        <div class="pdf-box" id="box-enu">
            <div class="pdf-header"><strong>üìù ENUNCIADO</strong><button class="action-btn" onclick="foco('enu')">EXPANDIR</button></div>
            <iframe id="v-enu"></iframe>
        </div>
        <div class="pdf-box" id="box-gab">
            <div class="pdf-header"><strong>‚úÖ GABARITO</strong><button class="action-btn" onclick="foco('gab')">EXPANDIR</button></div>
            <iframe id="v-gab"></iframe>
        </div>
    </section>
</main>

<script>
    let arquivoAtivo = "ro35";
    let links = { enu: "ro35.pdf", gab: "ro35-gabarito.pdf" };

    // BANCO DE DADOS INTELIGENTE (Captura autom√°tica simulada para o Exame 35)
    const dbInteligente = {
        "ro35": [
            { tipo: "Lei", texto: "Art. 895, I, da CLT (Cabimento do Recurso Ordin√°rio)" },
            { tipo: "S√∫mula", texto: "S√∫mula 338, I, do TST (√înus da prova das horas extras)" },
            { tipo: "OJ", texto: "OJ 394 da SBDI-1 do TST (Repouso Semanal Remunerado)" },
            { tipo: "Artigo", texto: "Art. 5¬∫, LV, da CF/88 (Cerceamento de Defesa)" }
        ]
    };

    function renderizarTeses() {
        const container = document.getElementById('container-teses');
        const dados = JSON.parse(localStorage.getItem('teses_' + arquivoAtivo)) || dbInteligente[arquivoAtivo] || [];
        container.innerHTML = dados.map((t, i) => `
            <div class="tese-item">
                <span class="tese-tag">${t.tipo}</span>
                <textarea onchange="editarTese(${i}, this.value)">${t.texto}</textarea>
                <button onclick="excluirTese(${i})" style="align-self:flex-end; border:none; background:none; color:red; cursor:pointer; font-size:0.7rem;">EXCLUIR</button>
            </div>
        `).join('');
    }

    function editarTese(i, val) {
        let d = JSON.parse(localStorage.getItem('teses_' + arquivoAtivo)) || dbInteligente[arquivoAtivo];
        d[i].texto = val;
        localStorage.setItem('teses_' + arquivoAtivo, JSON.stringify(d));
    }

    function excluirTese(i) {
        let d = JSON.parse(localStorage.getItem('teses_' + arquivoAtivo)) || dbInteligente[arquivoAtivo];
        d.splice(i, 1);
        localStorage.setItem('teses_' + arquivoAtivo, JSON.stringify(d));
        renderizarTeses();
    }

    function adicionarTese() {
        let d = JSON.parse(localStorage.getItem('teses_' + arquivoAtivo)) || dbInteligente[arquivoAtivo] || [];
        d.push({ tipo: "Nova", texto: "Digite a lei ou s√∫mula..." });
        localStorage.setItem('teses_' + arquivoAtivo, JSON.stringify(d));
        renderizarTeses();
    }

    function carregarExame(enu, gab, id) {
        arquivoAtivo = id; links.enu = enu; links.gab = gab;
        document.getElementById('v-enu').src = enu;
        document.getElementById('v-gab').src = gab;
        renderizarTeses();
        if (window.innerWidth < 900) switchTab('work');
    }

    // INTERFACE E AUXILIARES
    function foco(t) {
        const e = document.getElementById('box-enu'), g = document.getElementById('box-gab');
        if(t==='enu') { e.classList.toggle('focado'); g.classList.toggle('encolhido'); }
        else { g.classList.toggle('focado'); e.classList.toggle('encolhido'); }
    }

    function toggleTeses() { document.getElementById('panel-fundamentos').classList.toggle('open'); }
    
    function abrirEsqueleto(tipo) {
        const win = window.open("", "_blank", "width=500,height=600");
        win.document.write(`<body style="font-family:monospace; padding:20px;"><h3>Esqueleto: ${tipo}</h3><hr>Peti√ß√£o Inicial... Art. 840 CLT...</body>`);
    }

    function switchTab(id) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active-mobile'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active-mobile');
        document.getElementById('t-' + id).classList.add('active');
    }

    // TIMER E RESIZER
    function startTimer(sec, display) {
        setInterval(() => {
            let h = parseInt(sec/3600), m = parseInt((sec%3600)/60), s = parseInt(sec%60);
            display.textContent = `${h<10?'0'+h:h}:${m<10?'0'+m:m}:${s<10?'0'+s:s}`;
            if(--sec < 0) display.textContent = "FIM";
        }, 1000);
    }

    const resizer = document.getElementById('dragMe'), work = document.getElementById('work');
    resizer.addEventListener('mousedown', (e) => {
        const move = (ev) => { let w = ev.clientX - work.getBoundingClientRect().left; if(w>250) work.style.flex = `0 0 ${w}px`; };
        const stop = () => document.removeEventListener('mousemove', move);
        document.addEventListener('mousemove', move); document.addEventListener('mouseup', stop);
    });

    window.onload = () => { startTimer(18000, document.getElementById('timer')); renderizarTeses(); };

    function exportarTXT() {
        const blob = new Blob([document.getElementById('area-peca').value], {type:'text/plain'});
        const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = `Peca_${arquivoAtivo}.txt`; a.click();
    }
</script>
</body>
</html>
