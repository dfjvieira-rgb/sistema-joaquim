<style>
    /* ... manter variáveis anteriores ... */
    
    .editor-container { 
        padding: 40px 20px; 
        background: #e2e8f0; /* Fundo de mesa de escritório */
    }

    .paper { 
        background: #ffffff; 
        width: 100%; 
        max-width: 820px; 
        box-shadow: 0 10px 30px rgba(0,0,0,0.15), 0 0 1px rgba(0,0,0,0.2); 
        padding: 60px 0; /* Cabeçalho e Rodapé da folha */
        border-radius: 2px;
        position: relative;
    }

    /* Linha Profissional FGV */
    .linha-wrapper { 
        display: flex; 
        width: 100%; 
        border-bottom: 1px solid #d1d5db; /* Linha pautada mais nítida */
        position: relative;
        transition: background 0.2s;
    }
    
    .linha-wrapper:hover { background: #f8fafc; }

    /* Margem de Segurança (Linha Vermelha) */
    .linha-wrapper::before {
        content: '';
        position: absolute;
        left: 55px;
        top: 0;
        bottom: 0;
        width: 1px;
        background: rgba(239, 68, 68, 0.4); /* Margem clássica */
        pointer-events: none;
    }

    .linha-num { 
        width: 55px; 
        font-size: 0.75rem; 
        color: #64748b; 
        text-align: center; 
        background: #f8fafc; 
        padding-top: 10px; 
        font-family: 'Courier New', monospace;
        border-right: 1px solid #e2e8f0;
        user-select: none;
    }

    .linha-folha { 
        flex: 1; 
        height: 38px; /* Altura ideal para leitura */
        border: none; 
        outline: none; 
        background: transparent; 
        padding: 0 20px 0 15px; 
        font-size: 19px; 
        font-family: 'Georgia', serif; /* Fonte mais elegante e profissional */
        color: #0f172a;
        letter-spacing: 0.3px;
    }

    /* Estilo dos Separadores de Seção */
    .fgv-header { 
        background: #1e293b; 
        color: #fbbf24; 
        font-weight: 800; 
        padding: 12px; 
        text-align: center; 
        font-size: 0.7rem; 
        letter-spacing: 2px;
        text-transform: uppercase;
        border-y: 2px solid var(--gold);
        margin: 20px 0 5px 0;
    }
</style>

<script>
    // ... manter lógica anterior ...

    const criarFolha = () => {
        folha.innerHTML = '';
        // Simulação de cabeçalho oficial no topo da folha
        folha.innerHTML += `
            <div style="text-align:center; padding-bottom:30px; border-bottom:1px double #ccc; margin-bottom:20px; opacity:0.7">
                <small style="display:block; font-weight:bold; letter-spacing:1px">EXAME DE ORDEM UNIFICADO - CADERNO DE RESPOSTAS</small>
                <div style="display:flex; justify-content:center; gap:20px; margin-top:10px">
                    <div style="border:1px solid #000; padding:5px 15px; font-size:10px">PEÇA PROFISSIONAL</div>
                    <div style="border:1px solid #000; padding:5px 15px; font-size:10px">OPÇÃO: DIREITO DO TRABALHO</div>
                </div>
            </div>
        `;

        for(let i=1; i<=180; i++) {
            if(i === 1) folha.innerHTML += '<div class="fgv-header">PROVA DISCURSIVA - PEÇA PROFISSIONAL</div>';
            if(i === 51) folha.innerHTML += '<div class="fgv-header">QUESTÃO 01</div>';
            if(i === 81) folha.innerHTML += '<div class="fgv-header">QUESTÃO 02</div>';
            if(i === 111) folha.innerHTML += '<div class="fgv-header">QUESTÃO 03</div>';
            if(i === 141) folha.innerHTML += '<div class="fgv-header">QUESTÃO 04</div>';

            const wrap = document.createElement('div');
            wrap.className = 'linha-wrapper';
            const num = document.createElement('div');
            num.className = 'linha-num'; 
            num.innerText = i.toString().padStart(2, '0'); // Ex: 01, 02...
            
            const input = document.createElement('input');
            input.className = 'linha-folha';
            input.id = `L${i}`;
            input.spellcheck = false; // Evita sublinhados vermelhos chatos
            input.onfocus = () => ultimaLinhaFocada = i;
            input.oninput = salvar;

            wrap.appendChild(num);
            wrap.appendChild(input);
            folha.appendChild(wrap);
        }
    };
</script>
