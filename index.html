<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SISTEMA JOAQUIM - PRO</title>
    <title>SISTEMA JOAQUIM - MENTORIA</title>
    <style>
        :root { --primary: #0f172a; --accent: #3b82f6; --bg: #f8fafc; --sidebar-bg: #1e293b; --postit-yellow: #fef9c3; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #334155; padding-bottom: 60px; /* Espa√ßo para o post-it fixo */ }
        :root { --primary: #0f172a; --accent: #3b82f6; --bg: #f8fafc; --sidebar-bg: #1e293b; --postit-yellow: #fef9c3; --guia-bg: #ecfdf5; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); color: #334155; padding-bottom: 60px; }
        #login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); display: flex; align-items: center; justify-content: center; z-index: 9999; }
        #main-app { display: none; }
        header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: 800; border-bottom: 4px solid var(--accent); position: sticky; top: 0; z-index: 100; }
@@ -16,30 +16,37 @@
        .nav-btn { width: 100%; text-align: left; padding: 10px; margin-bottom: 5px; border: none; background: rgba(255,255,255,0.08); color: #f8fafc; cursor: pointer; border-radius: 6px; font-size: 0.75rem; }
        .nav-btn.active { background: var(--accent); font-weight: bold; }

        /* NOVO POST-IT FLUTUANTE/RETR√ÅTIL */
        .postit-fixed { position: fixed; bottom: 0; right: 20px; width: 300px; z-index: 1000; background: var(--postit-yellow); border: 1px solid #eab308; border-radius: 10px 10px 0 0; box-shadow: 0 -2px 15px rgba(0,0,0,0.1); transition: transform 0.3s; transform: translateY(210px); }
        /* POST-IT E BUSCA */
        .postit-fixed { position: fixed; bottom: 0; right: 20px; width: 320px; z-index: 1000; background: var(--postit-yellow); border: 1px solid #eab308; border-radius: 10px 10px 0 0; box-shadow: 0 -2px 15px rgba(0,0,0,0.2); transition: transform 0.3s; transform: translateY(280px); }
        .postit-fixed.open { transform: translateY(0); }
        .postit-header { background: #facc15; padding: 10px; cursor: pointer; display: flex; justify-content: space-between; font-weight: bold; font-size: 0.8rem; border-radius: 10px 10px 0 0; color: #854d0e; }
        .legal-search { padding: 8px; background: #fef08a; border-bottom: 1px solid #eab308; display: flex; gap: 5px; }
        .legal-search input { flex: 1; padding: 5px; border: 1px solid #ca8a04; border-radius: 4px; font-size: 0.7rem; }
        .legal-search button { padding: 5px 8px; background: #854d0e; color: white; border: none; border-radius: 4px; font-size: 0.6rem; cursor: pointer; }
        #aula-notes { width: 100%; height: 200px; padding: 10px; border: none; background: transparent; resize: none; font-family: 'Verdana', sans-serif; font-size: 0.85rem; outline: none; box-sizing: border-box; }

        .content-area { padding: 15px; flex-grow: 1; max-width: 900px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        #joaquim { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); min-height: 70vh; border: 1px solid #e2e8f0; font-family: 'Times New Roman', serif; }
        #joaquim { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); min-height: 70vh; border: 1px solid #e2e8f0; }
        
        .gabarito-panel { background: #f1f5f9; border: 2px solid var(--accent); padding: 12px; border-radius: 10px; margin-bottom: 20px; }
        .gab-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .gab-btn { background: var(--accent); color: white; border: none; padding: 8px; border-radius: 6px; font-weight: bold; font-size: 0.7rem; cursor: pointer; }
        .gab-content { display: none; margin-top: 15px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #ddd; white-space: pre-wrap; font-size: 0.9rem; }
        
        /* ESTILO DO GUIA DE ESTUDO */
        .guia-btn { width: 100%; background: #10b981; color: white; border: none; padding: 10px; border-radius: 6px; font-weight: bold; font-size: 0.75rem; cursor: pointer; margin-top: 8px; }
        .gab-content, .guia-content { display: none; margin-top: 15px; padding: 15px; background: white; border-radius: 8px; border: 1px solid #ddd; white-space: pre-wrap; font-size: 0.9rem; font-family: 'Times New Roman', serif; }
        .guia-content { background: var(--guia-bg); border-color: #10b981; color: #064e3b; }

        .copy-btn { width: 100%; margin-bottom: 20px; background: #10b981; color: white; border: none; padding: 15px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        #texto-final { outline: none; min-height: 400px; white-space: pre-wrap; margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 20px; }
        #texto-final { outline: none; min-height: 400px; white-space: pre-wrap; margin-top: 20px; border-top: 1px dashed #ccc; padding-top: 20px; font-family: 'Times New Roman', serif; }
    </style>
</head>
<body>

<div id="login-screen">
    <button onclick="liberar()" style="padding:20px; cursor:pointer; font-weight:bold; border-radius:8px; border:none; background:var(--accent); color:white;">ENTRAR NO SISTEMA</button>
</div>
<div id="login-screen"><button onclick="liberar()" style="padding:20px; cursor:pointer; font-weight:bold; border-radius:8px; border:none; background:var(--accent); color:white;">ENTRAR NO SISTEMA</button></div>

<div id="main-app">
    <header>PR√ÅTICA TRABALHISTA - 2¬™ FASE</header>
    <header>SISTEMA JOAQUIM - MENTORIA JUR√çDICA</header>
    <div class="main-layout">
        <nav class="sidebar" id="menuLateral"></nav>
        <main class="content-area">
@@ -48,11 +55,9 @@
    </div>

    <div class="postit-fixed" id="meuPostit">
        <div class="postit-header" onclick="togglePostit()">
            <span>üìå ANOTA√á√ïES DA AULA</span>
            <span id="setaPostit">‚ñ≤</span>
        </div>
        <textarea id="aula-notes" placeholder="Dicas da professora..."></textarea>
        <div class="postit-header" onclick="togglePostit()"><span>üìå NOTAS & CONSULTA</span><span id="setaPostit">‚ñ≤</span></div>
        <div class="legal-search"><input type="text" id="inputArtigo" placeholder="Ex: Art 467"><button onclick="consultarLei()">IR</button></div>
        <textarea id="aula-notes" placeholder="Notas de aula..."></textarea>
    </div>
</div>

@@ -78,44 +83,64 @@

    function loadPeca(key) {
        let botoes = '', blocos = '';
        const lista = dbGabaritos[key] || {};
        Object.keys(lista).forEach(num => {
            let id = `${key}_${num}`;
            botoes += `<button class="gab-btn" onclick="toggleG('${id}')">üìñ Gabarito ${num}</button>`;
            blocos += `<div id="${id}" class="gab-content"><strong>GABARITO ${num}:</strong>\n\n${lista[num]}</div>`;
        const dados = dbGabaritos[key] || {};
        
        // Separa o que √© gabarito num√©rico do que √© o guia
        Object.keys(dados).forEach(num => {
            if(!isNaN(num)) {
                let id = `${key}_${num}`;
                botoes += `<button class="gab-btn" onclick="toggleContent('${id}')">üìñ Gabarito ${num}</button>`;
                blocos += `<div id="${id}" class="gab-content"><strong>GABARITO ${num}:</strong>\n\n${dados[num]}</div>`;
            }
        });

        // Adiciona bot√£o de Guia se existir no gabaritos.js
        let guiaHtml = '';
        if(dados.guia) {
            guiaHtml = `
                <button class="guia-btn" onclick="toggleContent('${key}_guia')">üí° POR QUE ESSA FUNDAMENTA√á√ÉO?</button>
                <div id="${key}_guia" class="guia-content"><strong>GUIA DE ESTUDO - L√ìGICA JUR√çDICA:</strong>\n\n${dados.guia}</div>
            `;
        }

        document.getElementById('joaquim').innerHTML = `
            <button class="copy-btn" onclick="copyContent()">COPIAR PETI√á√ÉO</button>
            <div class="gabarito-panel"><div class="gab-grid">${botoes}</div>${blocos}</div>
            <div class="gabarito-panel">
                <div class="gab-grid">${botoes}</div>
                ${guiaHtml}
                ${blocos}
            </div>
            <div id="texto-final" contenteditable="true">ID: 936045\n\n(Escreva sua pe√ßa aqui...)</div>
        `;
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        if(document.getElementById('btn_'+key)) document.getElementById('btn_'+key).classList.add('active');
    }

    function toggleG(id) {
    function toggleContent(id) {
        const el = document.getElementById(id);
        const vis = el.style.display === 'block';
        document.querySelectorAll('.gab-content').forEach(d => d.style.display = 'none');
        document.querySelectorAll('.gab-content, .guia-content').forEach(d => d.style.display = 'none');
        el.style.display = vis ? 'none' : 'block';
    }

    function consultarLei() {
        const q = document.getElementById('inputArtigo').value.toLowerCase();
        if(!q) return;
        window.open(q.includes("sum") ? "https://www3.tst.jus.br/jurisprudencia/Sumulas_com_indice/Sumulas_Indice_1_50.html" : "http://www.planalto.gov.br/ccivil_03/decreto-lei/del5452.htm", '_blank');
    }

    function togglePostit() {
        const p = document.getElementById('meuPostit');
        p.classList.toggle('open');
        document.getElementById('setaPostit').innerText = p.classList.contains('open') ? '‚ñº' : '‚ñ≤';
    }

    document.getElementById('aula-notes').addEventListener('input', (e) => {
        localStorage.setItem('joaquim_notas', e.target.value);
    });
    document.getElementById('aula-notes').addEventListener('input', (e) => localStorage.setItem('joaquim_notas', e.target.value));

    function copyContent() {
        const texto = document.getElementById('texto-final').innerText;
        const area = document.createElement('textarea');
        area.value = texto; document.body.appendChild(area);
        area.select(); document.execCommand('copy');
        document.body.removeChild(area); alert("Copiado!");
        const t = document.getElementById('texto-final').innerText;
        const a = document.createElement('textarea'); a.value = t; document.body.appendChild(a);
        a.select(); document.execCommand('copy'); document.body.removeChild(a); alert("Copiado!");
    }
</script>
