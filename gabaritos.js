/**
 * gabarito.js - Vers√£o Otimizada 2026
 * Implementa limpeza autom√°tica de rodap√©s/redes sociais e formata√ß√£o de par√°grafos.
 */

// 1. BANCO DE DADOS (PARTE 1)
window.dbGabaritosExternos = {
    'rt': {
        1: `1.2.EXERC√çCIO I DE RECLAMA√á√ÉO TRABALHISTA
Jos√© Fininho foi contratado pela empresa Heart Attack Grill Ltda., para trabalhar na cidade de Florian√≥polis/SC, como gar√ßom, mediante sal√°rio de R$ 2.000,00.
O empregado afirma que uma das especialidades da Lanchonete era o sandu√≠che denominado quadruple bypass com 4 hamb√∫rgueres: 1 quilo de carne e 8.000 calorias.
Relata que foi contratado no mesmo dia em que Juan para exercer a mesma fun√ß√£o, na mesma filial. O trabalho se dava com a mesma perfei√ß√£o t√©cnica e produtividade, por√©m Juan recebia sal√°rio fixo de R$ 2.500,00 por m√™s.

O senhor Fininho conta que, em janeiro do ano da extin√ß√£o do contrato, faltou ao trabalho por um dia para comparecer em ju√≠zo como parte no processo em que litigava contra seu ex-empregador. Embora tenha apresentado a certid√£o da Justi√ßa do Trabalho confirmando suas alega√ß√µes, o dia foi descontado do seu sal√°rio.

O empregado comenta tamb√©m que trabalhava 8 horas di√°rias de segunda a sexta-feira e usufru√≠a de apenas 30 minutos de intervalo intrajornada.
No curso do contrato, o empregador depositava apenas 4% do valor da remunera√ß√£o a t√≠tulo de FGTS, pois havia acordo coletivo de trabalho autorizando o recolhimento de apenas metade do valor.

RESOLU√á√ÉO
AO DOUTO JU√çZO DA ... VARA DO TRABALHO DE FLORIAN√ìPOLIS/SC
JOS√â FININHO, gar√ßom, qualifica√ß√£o e endere√ßo completos, com fulcro no art. 840, caput e ¬ß 1¬∫, da CLT, PROPOR:
RECLAMA√á√ÉO TRABALHISTA em face de HEART ATTACK GRILL LTDA. e SINDICATO DOS EMPREGADOS ..., pelas raz√µes de fato e de direito a seguir expostas.

I ‚Äì M√âRITO
1. Equipara√ß√£o salarial (Art. 461, CLT)
2. Devolu√ß√£o do desconto (Art. 473, VIII, CLT / S√∫mula 155 TST)
3. Intervalo intrajornada (Art. 71, caput e ¬ß 4¬∫ CLT)
4. Diferen√ßas de FGTS (Art. 611-B, III, CLT e Art. 15 Lei 8.036/90)
5. Honor√°rios advocat√≠cios (Art. 791-A da CLT).

Atribui-se √† causa o valor de R$... .
Nestes termos, pede deferimento. Local e data. Advogado(a) OAB n¬∫`,
        'guia': `üí° DICAS DE MENTORIA - RECLAMA√á√ÉO TRABALHISTA:\n\n1. EQUIPARA√á√ÉO: Art. 461 CLT. Requisitos preenchidos no enunciado.\n2. DESCONTO INDEVIDO: Art. 473, VIII CLT. Comparecimento em ju√≠zo como parte n√£o gera desconto.\n3. INTERVALO: Art. 71 CLT. Jornada > 6h exige 1h de intervalo.\n4. FGTS: Art. 611-B, III CLT. FGTS √© direito indispon√≠vel.`
    },

    'consigna': {
        1: `6.3. EXERC√çCIO DE A√á√ÉO DE CONSIGNA√á√ÉO EM PAGAMENTO
ZENGA MODAS LTDA. dispensa Joana Firmino. Joana cientificada de que deveria comparecer para receber verbas rescis√≥rias, mas n√£o compareceu.

AO DOUTO JU√çZO DA ... VARA DO TRABALHO DE MACEI√ì/AL.
ZENGA MODAS LTDA., com fulcro no art. 539 do CPC c/c art. 769 da CLT, PROPOR:
A√á√ÉO DE CONSIGNA√á√ÉO EM PAGAMENTO em face de JOANA FIRMINO.

I ‚Äì FATOS
A consignat√°ria n√£o compareceu na data designada para o recebimento das verbas e do seu telefone celular pessoal deixado na empresa.

II ‚Äì M√âRITO
Pretende o dep√≥sito das verbas (Saldo Sal√°rio, Aviso Pr√©vio, 13¬∫, F√©rias em dobro e proporcionais, Multa FGTS), bem como devolu√ß√£o do celular e da CTPS (Art. 542, I CPC). Ressalte-se ser indevida a multa do Art. 477, ¬ß 8¬∫ da CLT pois n√£o h√° atraso por culpa da empresa.

III ‚Äì REQUERIMENTOS FINAIS
a) o deferimento do dep√≥sito dos valores, celular e CTPS (art. 542, I, do CPC);
b) a cita√ß√£o da consignat√°ria para levantar os valores ou oferecer resposta;
c) a proced√™ncia do pedido com a declara√ß√£o de extin√ß√£o da obriga√ß√£o e condena√ß√£o em honor√°rios de 15% (art. 791-A da CLT).`,
        'guia': `üí° DICAS DE MENTORIA - CONSIGNA√á√ÉO:\n\n1. OBJETO: A consigna√ß√£o serve para dinheiro E coisas (celular, CTPS). Art. 539 CPC.\n2. TESE: Afastar a multa do Art. 477 da CLT alegando que a demora n√£o √© culpa do patr√£o.`
    },

    'cont': {
        1: `2.6. EXERC√çCIO DE CONTESTA√á√ÉO (EOB XXV)
FLORICULTURA FLORES BELAS LTDA. vs ESTELA.

AO DOUTO JU√çZO DA 50¬™ VARA DO TRABALHO DE JO√ÉO PESSOA/PARA√çBA
Processo no 98.765.
FLORICULTURA FLORES BELAS LTDA., com fulcro nos arts. 847 da CLT e 343 do CPC, OFERECER:
CONTESTA√á√ÉO com pedido de reconven√ß√£o √† reclama√ß√£o trabalhista de ESTELA.

I ‚Äì PRELIMINAR: Incompet√™ncia (Art. 337, II CPC) para crimes e In√©pcia da inicial (Art. 330, CPC).
II ‚Äì PREJUDICIAL: Prescri√ß√£o quinquenal (Art. 7¬∫, XXIX CF / Art. 11 CLT).
III ‚Äì M√âRITO: Adicional de Penosidade (Falta de lei), Horas Extras (Dentro do limite), Multa 477 (Pagamento no prazo ap√≥s aviso projetado) e Plano de Sa√∫de (S√∫mula 342 TST).
IV ‚Äì RECONVEN√á√ÉO: Dano Material pela vidra√ßa quebrada (Art. 186 e 927 CC). Requer indeniza√ß√£o de R$ 300,00.

V ‚Äì REQUERIMENTOS FINAIS: Improced√™ncia dos pedidos da autora e proced√™ncia da reconven√ß√£o.`,
        'guia': `üí° POR QUE ESSA FUNDAMENTA√á√ÉO?\n\n1. RECONVEN√á√ÉO: Fundamental para cobrar o preju√≠zo causado pela empregada (vidra√ßa).\n2. PRESCRI√á√ÉO: Pe√ßa a extin√ß√£o do que passou de 5 anos.\n3. PENOSIDADE: Sem lei regulamentadora, o pedido √© improcedente.`
    },

    'emb_exec': {
        1: `8.3. EXERC√çCIO DE EMBARGOS √Ä EXECU√á√ÉO
R√îMULO DELGADO SILVA vs S√îNIA CRISTINA. Penhora de im√≥vel √∫nico (bem de fam√≠lia) e aplica√ß√£o de multa do CPC.

AO DOUTO JU√çZO DA 50a VARA DO TRABALHO DE BOA VISTA/RR
Processo no xxx
R√îMULO DELGADO SILVA, com fulcro no art. 884 da CLT, APRESENTAR:
EMBARGOS √Ä EXECU√á√ÉO em face de S√îNIA CRISTINA DE ALMEIDA.

I ‚Äì REQUISITOS: Garantia integral do ju√≠zo e Tempestividade (5 dias).
II ‚Äì M√âRITO: 
1. Impenhorabilidade do bem de fam√≠lia (Lei 8.009/90 e S√∫mula 364 STJ).
2. Multa do art. 523, ¬ß 1¬∫, do CPC: Inaplic√°vel ao Processo do Trabalho (Rito pr√≥prio dos arts. 880 e 882 CLT).
3. Excesso de penhora (Art. 883 CLT).

IV ‚Äì REQUERIMENTOS FINAIS: Notifica√ß√£o da embargada e proced√™ncia dos pedidos para desconstituir a penhora.`,
        'guia': `üí° DICAS DE MENTORIA - EMBARGOS:\n\n1. BEM DE FAM√çLIA: Prote√ß√£o absoluta para moradia √∫nica.\n2. MULTA 523 CPC: Inaplic√°vel ao Processo do Trabalho.\n3. PRAZO: 5 dias ap√≥s a garantia do ju√≠zo.`
    },

    'ro': { 1: `(Texto de Recurso Ordin√°rio ser√° inserido aqui)` },
    'ed': { 1: `(Texto de Embargos de Declara√ß√£o ser√° inserido aqui)` },
    'ap': { 1: `(Texto de Agravo de Peti√ß√£o ser√° inserido aqui)` },
    'ai': { 1: `(Texto de Agravo de Instrumento ser√° inserido aqui)` },
    'rr': { 1: `(Texto de Recurso de Revista ser√° inserido aqui)` },
    'epe': { 1: `(Texto de Exce√ß√£o de Pr√©-Executividade ser√° inserido aqui)` },
    'ms': { 1: `(Texto de Mandado de Seguran√ßa ser√° inserido aqui)` }
};

// 2. L√ìGICA DE GERENCIAMENTO E LIMPEZA
const GabaritoManager = {
    config: {
        removerRodapes: /P\s?√°\s?gi\s?na\s\d+\s\|\s\d+/gi, 
        removerSociais: /@aryannalinhares|@professoraaryannalinhares/gi,
        espacosExtras: /\n{3,}/g, 
    },

    formatarTexto: function(texto) {
        if (!texto) return "";
        let textoLimpo = texto;

        // Limpeza de rodap√©s e redes sociais
        textoLimpo = textoLimpo.replace(this.config.removerRodapes, "");
        textoLimpo = textoLimpo.replace(this.config.removerSociais, "");
        textoLimpo = textoLimpo.replace(this.config.espacosExtras, "\n\n");
        
        // Transforma√ß√£o em par√°grafos HTML para visibilidade
        const blocos = textoLimpo.split(/\n/);
        return blocos
            .map(linha => {
                const conteudo = linha.trim();
                if (conteudo.length > 0) {
                    return `<p style="margin-bottom: 12px; line-height: 1.6; text-align: justify;">${conteudo}</p>`;
                }
                return "";
            })
            .join("");
    },

    renderizarNoSite: function(categoria, questao) {
        const container = document.getElementById('container-gabarito');
        if (window.dbGabaritosExternos && window.dbGabaritosExternos[categoria]) {
            const textoBruto = window.dbGabaritosExternos[categoria][questao];
            if (textoBruto) {
                container.innerHTML = this.formatarTexto(textoBruto);
            } else {
                container.innerHTML = "<p>Gabarito n√£o encontrado.</p>";
            }
        }
    }
};
