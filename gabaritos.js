/**
 * gabarito.js - VersÃ£o Completa (19 PeÃ§as)
 * Banco de dados com limpeza de rodapÃ© e formataÃ§Ã£o jurÃ­dica.
 */

// 1. BANCO DE DADOS INTEGRAL (19 CATEGORIAS)
window.dbGabaritosExternos = {
    'rt': {
        1: `1.2.EXERCÃCIO I DE RECLAMAÃ‡ÃƒO TRABALHISTA
JosÃ© Fininho foi contratado pela empresa Heart Attack Grill Ltda., para trabalhar na cidade de FlorianÃ³polis/SC, como garÃ§om, mediante salÃ¡rio de R$ 2.000,00.
O empregado afirma que uma das especialidades da Lanchonete era o sanduÃ­che denominado quadruple bypass com 4 hambÃºrgueres: 1 quilo de carne e 8.000 calorias.
Relata que foi contratado no mesmo dia em que Juan para exercer a mesma funÃ§Ã£o, na mesma filial. O trabalho se dava com a mesma perfeiÃ§Ã£o tÃ©cnica e produtividade, porÃ©m Juan recebia salÃ¡rio fixo de R$ 2.500,00 por mÃªs.

O senhor Fininho conta que, em janeiro do ano da extinÃ§Ã£o do contrato, faltou ao trabalho por um dia para comparecer em juÃ­zo como parte no processo em que litigava contra seu ex-empregador. Embora tenha apresentado a certidÃ£o da JustiÃ§a do Trabalho confirmando suas alegaÃ§Ãµes, o dia foi descontado do seu salÃ¡rio.

O empregado comenta tambÃ©m que trabalhava 8 horas diÃ¡rias de segunda a sexta-feira e usufruÃ­a de apenas 30 minutos de intervalo intrajornada.
No curso do contrato, o empregador depositava apenas 4% do valor da remuneraÃ§Ã£o a tÃ­tulo de FGTS, pois havia acordo coletivo de trabalho autorizando o recolhimento de apenas metade do valor.

RESOLUÃ‡ÃƒO
AO DOUTO JUÃZO DA ... VARA DO TRABALHO DE FLORIANÃ“POLIS/SC
JOSÃ‰ FININHO, garÃ§om, qualificaÃ§Ã£o e endereÃ§o completos, com fulcro no art. 840, caput e Â§ 1Âº, da CLT, PROPOR:
RECLAMAÃ‡ÃƒO TRABALHISTA em face de HEART ATTACK GRILL LTDA. e SINDICATO DOS EMPREGADOS ..., pelas razÃµes de fato e de direito a seguir expostas.

I â€“ MÃ‰RITO
1. EquiparaÃ§Ã£o salarial (Art. 461, CLT)
2. DevoluÃ§Ã£o do desconto (Art. 473, VIII, CLT / SÃºmula 155 TST)
3. Intervalo intrajornada (Art. 71, caput e Â§ 4Âº CLT)
4. DiferenÃ§as de FGTS (Art. 611-B, III, CLT e Art. 15 Lei 8.036/90)
5. HonorÃ¡rios advocatÃ­cios (Art. 791-A da CLT).

Atribui-se Ã  causa o valor de R$... .
Nestes termos, pede deferimento. Local e data. Advogado(a) OAB nÂº`,
        'guia': `ðŸ’¡ DICAS DE MENTORIA - RECLAMAÃ‡ÃƒO TRABALHISTA:\n\n1. EQUIPARAÃ‡ÃƒO: Art. 461 CLT. Requisitos preenchidos no enunciado.\n2. DESCONTO INDEVIDO: Art. 473, VIII CLT. Comparecimento em juÃ­zo como parte nÃ£o gera desconto.\n3. INTERVALO: Art. 71 CLT. Jornada > 6h exige 1h de intervalo.\n4. FGTS: Art. 611-B, III CLT. FGTS Ã© direito indisponÃ­vel.`
    },

    'consigna': {
        1: `6.3. EXERCÃCIO DE AÃ‡ÃƒO DE CONSIGNAÃ‡ÃƒO EM PAGAMENTO
ZENGA MODAS LTDA. dispensa Joana Firmino. Joana cientificada de que deveria comparecer para receber verbas rescisÃ³rias, mas nÃ£o compareceu.

AO DOUTO JUÃZO DA ... VARA DO TRABALHO DE MACEIÃ“/AL.
ZENGA MODAS LTDA., com fulcro no art. 539 do CPC c/c art. 769 da CLT, PROPOR:
AÃ‡ÃƒO DE CONSIGNAÃ‡ÃƒO EM PAGAMENTO em face de JOANA FIRMINO.

I â€“ FATOS
A consignatÃ¡ria nÃ£o compareceu na data designada para o recebimento das verbas e do seu telefone celular pessoal deixado na empresa.

II â€“ MÃ‰RITO
Pretende o depÃ³sito das verbas (Saldo SalÃ¡rio, Aviso PrÃ©vio, 13Âº, FÃ©rias em dobro e proporcionais, Multa FGTS), bem como devoluÃ§Ã£o do celular e da CTPS (Art. 542, I CPC). Ressalte-se ser indevida a multa do Art. 477, Â§ 8Âº da CLT pois nÃ£o hÃ¡ atraso por culpa da empresa.

III â€“ REQUERIMENTOS FINAIS
a) o deferimento do depÃ³sito dos valores, celular e CTPS (art. 542, I, do CPC);
b) a citaÃ§Ã£o da consignatÃ¡ria para levantar os valores ou oferecer resposta;
c) a procedÃªncia do pedido com a declaraÃ§Ã£o de extinÃ§Ã£o da obrigaÃ§Ã£o e condenaÃ§Ã£o em honorÃ¡rios de 15% (art. 791-A da CLT).`,
        'guia': `ðŸ’¡ DICAS DE MENTORIA - CONSIGNAÃ‡ÃƒO:\n\n1. OBJETO: A consignaÃ§Ã£o serve para dinheiro E coisas (celular, CTPS). Art. 539 CPC.\n2. TESE: Afastar a multa do Art. 477 da CLT alegando que a demora nÃ£o Ã© culpa do patrÃ£o.`
    },

    'cont': {
        1: `2.6. EXERCÃCIO DE CONTESTAÃ‡ÃƒO (EOB XXV)
FLORICULTURA FLORES BELAS LTDA. vs ESTELA.

AO DOUTO JUÃZO DA 50Âª VARA DO TRABALHO DE JOÃƒO PESSOA/PARAÃBA
Processo no 98.765.
FLORICULTURA FLORES BELAS LTDA., com fulcro nos arts. 847 da CLT e 343 do CPC, OFERECER:
CONTESTAÃ‡ÃƒO com pedido de reconvenÃ§Ã£o Ã  reclamaÃ§Ã£o trabalhista de ESTELA.

I â€“ PRELIMINAR: IncompetÃªncia (Art. 337, II CPC) para crimes e InÃ©pcia da inicial (Art. 330, CPC).
II â€“ PREJUDICIAL: PrescriÃ§Ã£o quinquenal (Art. 7Âº, XXIX CF / Art. 11 CLT).
III â€“ MÃ‰RITO: Adicional de Penosidade (Falta de lei), Horas Extras (Dentro do limite), Multa 477 (Pagamento no prazo apÃ³s aviso projetado) e Plano de SaÃºde (SÃºmula 342 TST).
IV â€“ RECONVENÃ‡ÃƒO: Dano Material pela vidraÃ§a quebrada (Art. 186 e 927 CC). Requer indenizaÃ§Ã£o de R$ 300,00.

V â€“ REQUERIMENTOS FINAIS: ImprocedÃªncia dos pedidos da autora e procedÃªncia da reconvenÃ§Ã£o.`,
        'guia': `ðŸ’¡ POR QUE ESSA FUNDAMENTAÃ‡ÃƒO?\n\n1. RECONVENÃ‡ÃƒO: Fundamental para cobrar o prejuÃ­zo causado pela empregada (vidraÃ§a).\n2. PRESCRIÃ‡ÃƒO: PeÃ§a a extinÃ§Ã£o do que passou de 5 anos.\n3. PENOSIDADE: Sem lei regulamentadora, o pedido Ã© improcedente.`
    },

    'emb_exec': {
        1: `8.3. EXERCÃCIO DE EMBARGOS Ã€ EXECUÃ‡ÃƒO
RÃ”MULO DELGADO SILVA vs SÃ”NIA CRISTINA. Penhora de imÃ³vel Ãºnico (bem de famÃ­lia) e aplicaÃ§Ã£o de multa do CPC.

AO DOUTO JUÃZO DA 50a VARA DO TRABALHO DE BOA VISTA/RR
Processo no xxx
RÃ”MULO DELGADO SILVA, com fulcro no art. 884 da CLT, APRESENTAR:
EMBARGOS Ã€ EXECUÃ‡ÃƒO em face de SÃ”NIA CRISTINA DE ALMEIDA.

I â€“ REQUISITOS: Garantia integral do juÃ­zo e Tempestividade (5 dias).
II â€“ MÃ‰RITO: 
1. Impenhorabilidade do bem de famÃ­lia (Lei 8.009/90 e SÃºmula 364 STJ).
2. Multa do art. 523, Â§ 1Âº, do CPC: InaplicÃ¡vel ao Processo do Trabalho (Rito prÃ³prio dos arts. 880 e 882 CLT).
3. Excesso de penhora (Art. 883 CLT).

IV â€“ REQUERIMENTOS FINAIS: NotificaÃ§Ã£o da embargada e procedÃªncia dos pedidos para desconstituir a penhora.`,
        'guia': `ðŸ’¡ DICAS DE MENTORIA - EMBARGOS:\n\n1. BEM DE FAMÃLIA: ProteÃ§Ã£o absoluta para moradia Ãºnica.\n2. MULTA 523 CPC: InaplicÃ¡vel ao Processo do Trabalho.\n3. PRAZO: 5 dias apÃ³s a garantia do juÃ­zo.`
    },

    // --- LISTA COMPLETA DE 19 CATEGORIAS ---
    'ro': { 1: "" }, // Recurso OrdinÃ¡rio
    'ed': { 1: "" }, // Embargos de DeclaraÃ§Ã£o
    'ap': { 1: "" }, // Agravo de PetiÃ§Ã£o
    'ai': { 1: "" }, // Agravo de Instrumento
    'rr': { 1: "" }, // Recurso de Revista
    'epe': { 1: "" }, // ExceÃ§Ã£o de PrÃ©-Executividade
    'ms': { 1: "" }, // Mandado de SeguranÃ§a
    'acao_resc': { 1: "" }, // AÃ§Ã£o RescisÃ³ria
    'inquerito': { 1: "" }, // InquÃ©rito para ApuraÃ§Ã£o de Falta Grave
    'cautelar': { 1: "" }, // Medida Cautelar
    'habeas_corpus': { 1: "" }, // Habeas Corpus
    'habeas_data': { 1: "" }, // Habeas Data
    'mandado_injuncao': { 1: "" }, // Mandado de InjunÃ§Ã£o
    'dissidio_coletivo': { 1: "" }, // DissÃ­dio Coletivo
    'recurso_adesivo': { 1: "" } // Recurso Adesivo
};

// 2. LÃ“GICA DE GERENCIAMENTO E FORMATAÃ‡ÃƒO JURÃDICA
const GabaritoManager = {
    config: {
        sujeiraRodape: /(P\s?Ã¡\s?gi\s?na\s*\d+\s*\|\s*\d+)|(@professoraaryannalinhares)|(@aryannalinhares)/gi,
    },

    formatarTexto: function(textoBruto) {
        if (!textoBruto) return "";
        let textoLimpo = textoBruto.replace(this.config.sujeiraRodape, "");
        const linhas = textoLimpo.split('\n');
        let htmlFinal = "";
        let paragrafoAcumulado = "";

        linhas.forEach(linha => {
            const limpa = linha.trim();
            if (limpa === "") {
                if (paragrafoAcumulado !== "") {
                    htmlFinal += `<p style="margin-bottom: 1.5em; text-indent: 2.5cm; text-align: justify;">${paragrafoAcumulado}</p>`;
                    paragrafoAcumulado = "";
                }
            } else {
                const ehTitulo = /^(I+|[0-9]+\.|AO DOUTO|RECLAMAÃ‡ÃƒO|Atribui-se|Nestes|RESOLUÃ‡ÃƒO|II â€“|III â€“|IV â€“|V â€“)/i.test(limpa);
                if (ehTitulo) {
                    if (paragrafoAcumulado !== "") {
                        htmlFinal += `<p style="margin-bottom: 1.5em; text-indent: 2.5cm; text-align: justify;">${paragrafoAcumulado}</p>`;
                    }
                    htmlFinal += `<div style="font-weight: bold; text-transform: uppercase; margin-top: 25px; margin-bottom: 10px; text-align: left;">${limpa}</div>`;
                    paragrafoAcumulado = "";
                } else {
                    paragrafoAcumulado += (paragrafoAcumulado === "" ? "" : " ") + limpa;
                }
            }
        });

        if (paragrafoAcumulado !== "") {
            htmlFinal += `<p style="margin-bottom: 1.5em; text-indent: 2.5cm; text-align: justify;">${paragrafoAcumulado}</p>`;
        }
        return htmlFinal;
    },

    renderizarNoSite: function(categoria, questao) {
        const container = document.getElementById('container-gabarito');
        if (!container) return;
        
        if (window.dbGabaritosExternos && window.dbGabaritosExternos[categoria]) {
            const textoBruto = window.dbGabaritosExternos[categoria][questao];
            if (textoBruto && textoBruto.length > 5) {
                container.innerHTML = this.formatarTexto(textoBruto);
            } else {
                container.innerHTML = "<p style='text-align:center; padding-top: 100px; color:#999; font-family: sans-serif; text-indent: 0;'>Gabarito em fase de atualizaÃ§Ã£o tÃ©cnica.</p>";
            }
        }
    }
};
